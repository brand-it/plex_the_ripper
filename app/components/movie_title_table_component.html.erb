
<% if disks.any? %>
  <table class="table" id="<%= dom_id %>">
    <thead>
      <tr>
        <th>#</th>
        <th>Name(video title)</th>
        <th>Duration (<%= distance_of_time_in_words @movie.movie_runtime.seconds %>)</th>
        <th>Size</th>
        <th></th>
      </tr>
    </thead>
    <tbody class="disk_titles">
      <% disks.each do |disk| %>
        <% disk.disk_titles.sort_by { |d| movie.runtime_range.include?(d.duration) ? 0 : 1  }.each do |disk_title| %>
          <% text_class = 'text-primary-emphasis' if movie.runtime_range.include?(disk_title.duration) %>
          <% text_class = 'text-success-emphasis' if movie.disk_titles.include?(disk_title) %>
          <tr>
            <th scope="row" class="<%= text_class %>"><%= disk_title.id %></th>
            <td class="<%= text_class %>">
              <%= disk_title.name %>
              <% if disk_title.video %>
                (<%= disk_title.video&.title %>)
              <% end %>
            </td>
            <td class="<%= text_class %>"><%= distance_of_time_in_words(disk_title.duration.seconds) %></td>
            <td class="<%= disk_title.size >= free_disk_space ? 'text-danger' : text_class %>">
              <%= number_to_human_size(disk_title.size, precision: 3) %>
              <% if disk_title.size >= free_disk_space %>
                WARNING: Not enough space available to rip need another <%= number_to_human_size(disk_title.size - free_disk_space, precision: 3) %>
              <% end %>
            </td>
            <td class="<%= text_class %>">
              <%= link_to 'Rip', rip_movie_path(movie, disk_title_id: disk_title.id), data: { turbo_method: :post }, class: 'btn btn-outline-light' %>
            </td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
<% elsif LoadDiskWorker.job.active? %>
  <p class="text-info">Stand by the disk is still being loading from the CD drive this could take a while. Page will update once the disk is ready so no need to refresh the page but if you do it won't hurt anything.</p>
<% else %>
  <p class="text-warn">Sorry no Disk is currently loaded or could be detected. Refresh page if your seeing this warning but know a disk is present.</p>
<% end %>
